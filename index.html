<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Health & Routine Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1c2e 0%, #2c1f4a 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .date-display {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: #1e2030;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            transition: transform 0.3s ease;
            color: #e4e6f1;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h2 {
            color: #9fa6fb;
            margin-bottom: 20px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .icon {
            font-size: 1.3em;
        }

        .task-list {
            list-style: none;
        }

        .task-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin-bottom: 10px;
            background: #2a2d3e;
            color: #e4e6f1;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .task-item:hover {
            background: #353849;
        }

        .task-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .task-item.no-class {
            opacity: 0.4;
            background: #f1f3f5;
            pointer-events: none;
        }

        .no-class-message {
            text-align: center;
            padding: 15px;
            background: #2d3756;
            color: #9fa6fb;
            border-radius: 8px;
            font-weight: bold;
        }

        .class-day-active {
            background: #2d3756;
            border-left: 4px solid #9fa6fb;
        }

        .checkbox {
            width: 20px;
            height: 20px;
            margin-right: 15px;
            cursor: pointer;
        }

        .task-time {
            margin-left: auto;
            color: #667eea;
            font-weight: bold;
            font-size: 0.9em;
        }

        .meal-suggestion {
            background: #2d3756;
            color: #9fa6fb;
            padding: 10px;
            border-radius: 5px;
            margin-top: 5px;
            font-size: 0.9em;
        }

        .progress-card {
            grid-column: 1 / -1;
        }

        .progress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .progress-item {
            background: #2a2d3e;
            color: #e4e6f1;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .progress-item label {
            display: block;
            margin-bottom: 8px;
            color: #9fa6fb;
            font-weight: bold;
        }

        .progress-item input {
            width: 100%;
            padding: 8px;
            border: 2px solid #353849;
            border-radius: 5px;
            font-size: 1em;
            text-align: center;
            background: #1e2030;
            color: #e4e6f1;
        }

        .progress-value {
            font-size: 2em;
            color: #667eea;
            font-weight: bold;
            margin-top: 5px;
        }

        .health-tip {
            background: linear-gradient(135deg, #2d1f4a 0%, #3f2b63 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 10px;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.3s ease;
            margin-top: 10px;
        }

        .btn:hover {
            background: #5568d3;
        }

        .settings-panel {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1e2030;
            color: #e4e6f1;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            z-index: 1000;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .settings-panel.active {
            display: block;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }

        .overlay.active {
            display: block;
        }

        .close-btn {
            float: right;
            font-size: 1.5em;
            cursor: pointer;
            color: #999;
        }

        .setting-item {
            margin-bottom: 20px;
        }

        .setting-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #495057;
        }

        .setting-item input {
            width: 100%;
            padding: 10px;
            border: 2px solid #353849;
            border-radius: 5px;
            font-size: 1em;
            background: #2a2d3e;
            color: #e4e6f1;
        }

        .water-tracker {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .water-glass {
            width: 50px;
            height: 60px;
            border: 3px solid #667eea;
            border-radius: 5px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .water-glass.filled {
            background: linear-gradient(to top, #667eea 0%, #89a4f5 100%);
        }

        .stats-summary {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            padding: 20px;
            background: #2a2d3e;
            border-radius: 10px;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            color: #667eea;
            font-weight: bold;
        }

        .stat-label {
            color: #9fa6fb;
            margin-top: 5px;
        }

        .challenge-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
            gap: 8px;
            margin-top: 20px;
            padding: 10px;
        }

        .day-box {
            aspect-ratio: 1;
            border: 2px solid #353849;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.8em;
            background: #2a2d3e;
            color: #e4e6f1;
            transition: all 0.3s ease;
        }

        .day-box.completed {
            background: #4c566a;
            border-color: #667eea;
            color: #fff;
        }

        .day-box:hover {
            transform: scale(1.1);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #2a2d3e;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            margin-top: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #667eea, #764ba2);
            transition: width 0.3s ease;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 0.9em;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üåü Daily Health & Routine Tracker</h1>
            <div class="date-display" id="dateDisplay"></div>
        </header>

        <div class="dashboard">
            <!-- Morning Routine -->
            <div class="card">
                <h2><span class="icon">üåÖ</span> Morning Routine</h2>
                <ul class="task-list" id="morningTasks">
                    <li class="task-item" data-task="morning-1">
                        <input type="checkbox" class="checkbox">
                        <span>Wake-up & Stretch</span>
                        <span class="task-time">6:00 AM</span>
                    </li>
                    <li class="task-item" data-task="morning-2">
                        <input type="checkbox" class="checkbox">
                        <span>Water + Lemon</span>
                        <span class="task-time">6:15 AM</span>
                    </li>
                    <li class="task-item" data-task="morning-3">
                        <input type="checkbox" class="checkbox">
                        <span>Meditation (10 min)</span>
                        <span class="task-time">6:30 AM</span>
                    </li>
                    <li class="task-item" data-task="morning-4">
                        <input type="checkbox" class="checkbox">
                        <span>Morning Exercise</span>
                        <span class="task-time">7:00 AM</span>
                    </li>
                </ul>
            </div>

            <!-- Meal Reminders -->
            <div class="card">
                <h2><span class="icon">üçΩÔ∏è</span> Meal Reminders</h2>
                <ul class="task-list" id="mealTasks">
                    <li class="task-item" data-task="meal-1">
                        <input type="checkbox" class="checkbox">
                        <span>Breakfast</span>
                        <span class="task-time">8:00 AM</span>
                    </li>
                    <div class="meal-suggestion">ü•£ Oatmeal with fruits & nuts</div>
                    
                    <li class="task-item" data-task="meal-2">
                        <input type="checkbox" class="checkbox">
                        <span>Mid-Morning Snack</span>
                        <span class="task-time">11:00 AM</span>
                    </li>
                    <div class="meal-suggestion">üçé Fresh fruits or smoothie</div>
                    
                    <li class="task-item" data-task="meal-3">
                        <input type="checkbox" class="checkbox">
                        <span>Lunch</span>
                        <span class="task-time">1:00 PM</span>
                    </li>
                    <div class="meal-suggestion">ü•ó Whole grain roti with veggies & dal</div>
                    
                    <li class="task-item" data-task="meal-4">
                        <input type="checkbox" class="checkbox">
                        <span>Evening Snack</span>
                        <span class="task-time">5:00 PM</span>
                    </li>
                    <div class="meal-suggestion">ü•ú Nuts & green tea</div>
                    
                    <li class="task-item" data-task="meal-5">
                        <input type="checkbox" class="checkbox">
                        <span>Dinner</span>
                        <span class="task-time">7:30 PM</span>
                    </li>
                    <div class="meal-suggestion">üç≤ Light soup & salad</div>
                </ul>
            </div>

            <!-- Workout Reminders -->
            <div class="card">
                <h2><span class="icon">üí™</span> Workout & Exercise</h2>
                <ul class="task-list" id="workoutTasks">
                    <li class="task-item" data-task="workout-1">
                        <input type="checkbox" class="checkbox">
                        <span>Morning Yoga</span>
                        <span class="task-time">7:00 AM</span>
                    </li>
                    <li class="task-item" data-task="workout-2">
                        <input type="checkbox" class="checkbox">
                        <span>Gym / Home Workout</span>
                        <span class="task-time">6:00 PM</span>
                    </li>
                    <li class="task-item" data-task="workout-3">
                        <input type="checkbox" class="checkbox">
                        <span>Evening Walk (30 min)</span>
                        <span class="task-time">7:00 PM</span>
                    </li>
                </ul>
                <button class="btn" onclick="showSettings()">‚öôÔ∏è Customize Times</button>
            </div>

            <!-- Class Schedule -->
            <div class="card">
                <h2><span class="icon">üìö</span> Class Schedule</h2>
                <div id="classSchedule"></div>
                <ul class="task-list" id="classTasks" style="margin-top: 15px;"></ul>
                <button class="btn" onclick="showClassSettings()">‚öôÔ∏è Manage Classes</button>
            </div>

            <!-- Water Tracker -->
            <div class="card">
                <h2><span class="icon">üíß</span> Water Intake Tracker</h2>
                <p style="margin-bottom: 10px;">Goal: 8 glasses (5 liters) per day</p>
                <div class="water-tracker" id="waterTracker"></div>
                <div class="stats-summary">
                    <div class="stat">
                        <div class="stat-value" id="waterCount">0</div>
                        <div class="stat-label">Glasses Today</div>
                    </div>
                </div>
            </div>

            <!-- Health Tips -->
            <div class="card">
                <h2><span class="icon">üí°</span> Daily Health Tip</h2>
                <div class="health-tip" id="healthTip"></div>
            </div>

            <!-- Progress Tracking -->
            <div class="card progress-card">
                <h2><span class="icon">üìä</span> Progress Tracking</h2>
                <div class="progress-grid">
                    <div class="progress-item">
                        <label>Weight (kg)</label>
                        <input type="number" id="weightInput" placeholder="Enter weight" step="0.1">
                        <div class="progress-value" id="weightDisplay">--</div>
                    </div>
                    <div class="progress-item">
                        <label>Steps Today</label>
                        <input type="number" id="stepsInput" placeholder="Enter steps">
                        <div class="progress-value" id="stepsDisplay">--</div>
                    </div>
                    <div class="progress-item">
                        <label>Exercise (min)</label>
                        <input type="number" id="exerciseInput" placeholder="Minutes">
                        <div class="progress-value" id="exerciseDisplay">--</div>
                    </div>
                    <div class="progress-item">
                        <label>Sleep (hours)</label>
                        <input type="number" id="sleepInput" placeholder="Hours" step="0.5">
                        <div class="progress-value" id="sleepDisplay">--</div>
                    </div>
                </div>
                <div class="stats-summary">
                    <div class="stat">
                        <div class="stat-value" id="tasksCompleted">0</div>
                        <div class="stat-label">Tasks Completed</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="totalTasks">0</div>
                        <div class="stat-label">Total Tasks</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="completionRate">0%</div>
                        <div class="stat-label">Completion Rate</div>
                    </div>
                </div>
            </div>

            <!-- 90 Day Challenge Tracker -->
            <div class="card">
                <h2><span class="icon">üéØ</span> 90 Day Challenge</h2>
                <div class="progress-bar">
                    <div class="progress-fill" id="challengeProgress"></div>
                    <span class="progress-text" id="challengeProgressText">0/90 days</span>
                </div>
                <div class="challenge-grid" id="challengeGrid"></div>
                <div class="stats-summary">
                    <div class="stat">
                        <div class="stat-value" id="currentStreak">0</div>
                        <div class="stat-label">Current Streak</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="longestStreak">0</div>
                        <div class="stat-label">Longest Streak</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Panel -->
    <div class="overlay" id="overlay" onclick="closeSettings()"></div>
    <div class="settings-panel" id="settingsPanel">
        <span class="close-btn" onclick="closeSettings()">√ó</span>
        <h2 style="color: #667eea; margin-bottom: 20px;">‚öôÔ∏è Customize Your Schedule</h2>
        <div id="settingsContent"></div>
        <button class="btn" onclick="saveSettings()">Save Changes</button>
    </div>

    <script>
        // Health tips database
        const healthTips = [
            "üíß Drink plenty of water throughout the day to support digestion and prevent constipation.",
            "ü•ó Include fiber-rich foods like vegetables, fruits, and whole grains in your diet for better digestive health.",
            "üö∂ Regular physical activity helps improve blood circulation and promotes healing.",
            "üßò Practice stress-reducing activities like meditation or yoga to support overall wellness.",
            "üçå Eat foods rich in vitamins A, C, and E to promote tissue repair and healing.",
            "‚è∞ Maintain a regular eating schedule to keep your digestive system functioning smoothly.",
            "ü•ë Include healthy fats from nuts, seeds, and avocados for better nutrient absorption.",
            "üò¥ Get 7-8 hours of quality sleep each night to support your body's natural healing processes.",
            "üåø Try natural remedies like aloe vera juice or probiotic-rich foods for gut health.",
            "üö´ Avoid spicy, processed, and fried foods that can irritate the digestive system."
        ];

        // Initialize data storage
        let trackerData = {
            tasks: {},
            water: 0,
            progress: {
                weight: null,
                steps: null,
                exercise: null,
                sleep: null
            },
            classes: [
                { day: 1, name: 'Mathematics', time: '9:00 AM', duration: '2 hours' },
                { day: 1, name: 'Physics', time: '2:00 PM', duration: '1.5 hours' },
                { day: 3, name: 'Chemistry', time: '10:00 AM', duration: '2 hours' },
                { day: 3, name: 'Biology', time: '3:00 PM', duration: '1.5 hours' },
                { day: 4, name: 'Computer Science', time: '9:00 AM', duration: '2 hours' },
                { day: 4, name: 'English', time: '1:00 PM', duration: '1 hour' }
            ],
            challengeDays: Array(90).fill(false),
            currentStreak: 0,
            longestStreak: 0,
            lastReset: new Date().toDateString()
        };

        // Load data from storage
        function loadData() {
            const saved = localStorage.getItem('healthTrackerData');
            if (saved) {
                const loadedData = JSON.parse(saved);
                
                // Merge with default data to ensure all properties exist
                trackerData = {
                    tasks: loadedData.tasks || {},
                    water: loadedData.water || 0,
                    progress: loadedData.progress || {
                        weight: null,
                        steps: null,
                        exercise: null,
                        sleep: null
                    },
                    classes: loadedData.classes || [
                        { day: 1, name: 'Mathematics', time: '9:00 AM', duration: '2 hours' },
                        { day: 1, name: 'Physics', time: '2:00 PM', duration: '1.5 hours' },
                        { day: 3, name: 'Chemistry', time: '10:00 AM', duration: '2 hours' },
                        { day: 3, name: 'Biology', time: '3:00 PM', duration: '1.5 hours' },
                        { day: 4, name: 'Computer Science', time: '9:00 AM', duration: '2 hours' },
                        { day: 4, name: 'English', time: '1:00 PM', duration: '1 hour' }
                    ],
                    challengeDays: loadedData.challengeDays || Array(90).fill(false),
                    currentStreak: loadedData.currentStreak || 0,
                    longestStreak: loadedData.longestStreak || 0,
                    lastReset: loadedData.lastReset || new Date().toDateString()
                };
                
                // Reset daily data if it's a new day
                if (trackerData.lastReset !== new Date().toDateString()) {
                    trackerData.tasks = {};
                    trackerData.water = 0;
                    trackerData.lastReset = new Date().toDateString();
                }
            }
        }

        // Save data to storage
        function saveData() {
            localStorage.setItem('healthTrackerData', JSON.stringify(trackerData));
        }

        // Check if it's a new day and reset data
        function checkAndResetDay() {
            const today = new Date().toDateString();
            
            if (trackerData.lastReset !== today) {
                // Save yesterday's progress to history before resetting
                saveToHistory();
                
                // Reset daily data
                trackerData.tasks = {};
                trackerData.water = 0;
                trackerData.progress = {
                    weight: trackerData.progress.weight, // Keep weight
                    steps: null,
                    exercise: null,
                    sleep: null
                };
                trackerData.lastReset = today;
                
                saveData();
                
                // Refresh the UI
                location.reload();
            }
        }

        // Save progress to history
        function saveToHistory() {
            let history = JSON.parse(localStorage.getItem('healthHistory') || '[]');
            
            const todayData = {
                date: trackerData.lastReset,
                tasksCompleted: Object.values(trackerData.tasks).filter(Boolean).length,
                totalTasks: document.querySelectorAll('.task-item').length,
                water: trackerData.water,
                progress: { ...trackerData.progress }
            };
            
            history.push(todayData);
            
            // Keep only last 30 days
            if (history.length > 30) {
                history = history.slice(-30);
            }
            
            localStorage.setItem('healthHistory', JSON.stringify(history));
        }

        // Initialize app
        function init() {
            loadData();
            checkAndResetDay();
            updateDateDisplay();
            displayHealthTip();
            createWaterTracker();
            loadTaskStates();
            loadProgressValues();
            displayClassSchedule();
            updateStats();
            createChallengeGrid();
            updateStreaks();
            
            // Add event listeners
            document.querySelectorAll('.task-item').forEach(task => {
                task.addEventListener('click', toggleTask);
            });
            
            // Progress inputs
            ['weight', 'steps', 'exercise', 'sleep'].forEach(field => {
                const input = document.getElementById(field + 'Input');
                input.addEventListener('change', () => updateProgress(field, input.value));
            });
            
            // Check for day change every minute
            setInterval(checkAndResetDay, 60000);
            
            // Update date display every minute
            setInterval(updateDateDisplay, 60000);
            
            // Set notification permission
            if ('Notification' in window) {
                Notification.requestPermission();
            }
        }

        // Notification system
        function setupNotifications() {
            if (!('Notification' in window)) {
                console.log('This browser does not support notifications');
                return;
            }

            Notification.requestPermission().then(permission => {
                if (permission === 'granted') {
                    scheduleNotifications();
                }
            });
        }

        function scheduleNotifications() {
            // Clear any existing notification intervals
            if (window.notificationInterval) {
                clearInterval(window.notificationInterval);
            }

            // Check every minute for upcoming tasks
            window.notificationInterval = setInterval(() => {
                const now = new Date();
                const tasks = getAllTasks();
                
                tasks.forEach(task => {
                    const taskTime = parseTaskTime(task.time);
                    if (!taskTime) return;

                    // Calculate time difference in minutes
                    const timeDiff = (taskTime - now) / (1000 * 60);
                    
                    // If task is 10 minutes away and hasn't been notified
                    if (timeDiff <= 10 && timeDiff > 9 && !task.notified) {
                        sendNotification(task.name, task.time);
                        task.notified = true;
                    }
                });
            }, 60000); // Check every minute
        }

        function getAllTasks() {
            const tasks = [];
            
            // Morning exercise
            tasks.push({
                name: "Morning Exercise",
                time: "7:00 AM",
                type: "exercise"
            });

            // Classes for today
            const today = new Date().getDay();
            const todayClasses = trackerData.classes.filter(c => c.day === today);
            todayClasses.forEach(cls => {
                tasks.push({
                    name: cls.name,
                    time: cls.time,
                    type: "class"
                });
            });

            // Meals
            const meals = [
                { name: "Breakfast", time: "8:00 AM" },
                { name: "Mid-Morning Snack", time: "11:00 AM" },
                { name: "Lunch", time: "1:00 PM" },
                { name: "Evening Snack", time: "5:00 PM" },
                { name: "Dinner", time: "7:30 PM" }
            ];
            meals.forEach(meal => {
                tasks.push({
                    name: meal.name,
                    time: meal.time,
                    type: "meal"
                });
            });

            return tasks;
        }

        function parseTaskTime(timeStr) {
            const [time, period] = timeStr.split(' ');
            const [hours, minutes] = time.split(':');
            const now = new Date();
            const taskTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 
                period === 'PM' && hours !== '12' ? parseInt(hours) + 12 : 
                period === 'AM' && hours === '12' ? 0 : parseInt(hours),
                parseInt(minutes));
            return taskTime;
        }

        function sendNotification(taskName, taskTime) {
            const notification = new Notification("Upcoming Task Reminder", {
                body: `${taskName} is starting in 10 minutes (${taskTime})`,
                icon: "/icon.png", // Add your icon path
                badge: "/badge.png", // Add your badge path
                vibrate: [200, 100, 200]
            });

            notification.onclick = function() {
                window.focus();
                this.close();
            };

            // Play notification sound
            const audio = new Audio('/notification.mp3'); // Add your sound file path
            audio.play().catch(e => console.log('Audio play failed:', e));
        }

        // Update date display
        function updateDateDisplay() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('dateDisplay').textContent = new Date().toLocaleDateString('en-US', options);
        }

        // Display random health tip
        function displayHealthTip() {
            const tip = healthTips[Math.floor(Math.random() * healthTips.length)];
            document.getElementById('healthTip').textContent = tip;
        }

        // Toggle task completion
        function toggleTask(e) {
            const taskItem = e.currentTarget;
            const taskId = taskItem.dataset.task;
            const checkbox = taskItem.querySelector('.checkbox');
            
            checkbox.checked = !checkbox.checked;
            taskItem.classList.toggle('completed');
            
            trackerData.tasks[taskId] = checkbox.checked;
            saveData();
            updateStats();
        }

        // Load task states
        function loadTaskStates() {
            document.querySelectorAll('.task-item').forEach(task => {
                const taskId = task.dataset.task;
                if (trackerData.tasks[taskId]) {
                    task.classList.add('completed');
                    task.querySelector('.checkbox').checked = true;
                }
            });
        }

        // Create water tracker
        function createWaterTracker() {
            const container = document.getElementById('waterTracker');
            container.innerHTML = '';
            
            for (let i = 0; i < 5; i++) {
                const glass = document.createElement('div');
                glass.className = 'water-glass';
                if (i < trackerData.water) {
                    glass.classList.add('filled');
                }
                glass.addEventListener('click', () => toggleWaterGlass(i));
                container.appendChild(glass);
            }
            
            document.getElementById('waterCount').textContent = trackerData.water;
        }

        // Toggle water glass
        function toggleWaterGlass(index) {
            trackerData.water = index + 1;
            saveData();
            createWaterTracker();
        }

        // Update progress
        function updateProgress(field, value) {
            trackerData.progress[field] = parseFloat(value) || null;
            document.getElementById(field + 'Display').textContent = value || '--';
            saveData();
        }

        // Load progress values
        function loadProgressValues() {
            ['weight', 'steps', 'exercise', 'sleep'].forEach(field => {
                const value = trackerData.progress[field];
                if (value !== null) {
                    document.getElementById(field + 'Input').value = value;
                    document.getElementById(field + 'Display').textContent = value;
                }
            });
        }

        // Update statistics
        function updateStats() {
            const totalTasks = document.querySelectorAll('.task-item').length;
            const completedTasks = Object.values(trackerData.tasks).filter(Boolean).length;
            const rate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
            
            document.getElementById('tasksCompleted').textContent = completedTasks;
            document.getElementById('totalTasks').textContent = totalTasks;
            document.getElementById('completionRate').textContent = rate + '%';
        }

        // Challenge tracker functions
        function createChallengeGrid() {
            const grid = document.getElementById('challengeGrid');
            grid.innerHTML = '';
            
            trackerData.challengeDays.forEach((completed, index) => {
                const dayBox = document.createElement('div');
                dayBox.className = `day-box ${completed ? 'completed' : ''}`;
                dayBox.textContent = index + 1;
                dayBox.onclick = () => toggleDay(index);
                grid.appendChild(dayBox);
            });

            updateChallengeProgress();
        }

        function toggleDay(index) {
            trackerData.challengeDays[index] = !trackerData.challengeDays[index];
            saveData();
            createChallengeGrid();
            updateStreaks();
        }

        function updateChallengeProgress() {
            const completed = trackerData.challengeDays.filter(day => day).length;
            const progress = (completed / 90) * 100;
            
            document.getElementById('challengeProgress').style.width = `${progress}%`;
            document.getElementById('challengeProgressText').textContent = `${completed}/90 days`;
        }

        function updateStreaks() {
            let currentStreak = 0;
            let longestStreak = 0;
            let tempStreak = 0;

            trackerData.challengeDays.forEach((day, index) => {
                if (day) {
                    tempStreak++;
                    if (tempStreak > longestStreak) {
                        longestStreak = tempStreak;
                    }
                    if (index === trackerData.challengeDays.length - 1) {
                        currentStreak = tempStreak;
                    }
                } else {
                    tempStreak = 0;
                }
            });

            trackerData.currentStreak = currentStreak;
            trackerData.longestStreak = longestStreak;

            document.getElementById('currentStreak').textContent = currentStreak;
            document.getElementById('longestStreak').textContent = longestStreak;
            
            saveData();
        }

        // Settings functions
        function showSettings() {
            document.getElementById('settingsPanel').classList.add('active');
            document.getElementById('overlay').classList.add('active');
            
            const tasks = document.querySelectorAll('.task-item');
            let html = '';
            
            tasks.forEach(task => {
                const taskName = task.querySelector('span:not(.task-time)').textContent;
                const taskTime = task.querySelector('.task-time').textContent;
                const taskId = task.dataset.task;
                
                html += `
                    <div class="setting-item">
                        <label>${taskName}</label>
                        <input type="time" id="setting-${taskId}" value="${convertTo24Hour(taskTime)}">
                    </div>
                `;
            });
            
            document.getElementById('settingsContent').innerHTML = html;
        }

        function closeSettings() {
            document.getElementById('settingsPanel').classList.remove('active');
            document.getElementById('overlay').classList.remove('active');
        }

        function saveSettings() {
            const tasks = document.querySelectorAll('.task-item');
            
            tasks.forEach(task => {
                const taskId = task.dataset.task;
                const timeInput = document.getElementById('setting-' + taskId);
                if (timeInput) {
                    const time = convertTo12Hour(timeInput.value);
                    task.querySelector('.task-time').textContent = time;
                }
            });
            
            closeSettings();
            alert('‚úÖ Settings saved successfully!');
        }

        function convertTo24Hour(time12) {
            const [time, period] = time12.split(' ');
            let [hours, minutes] = time.split(':');
            hours = parseInt(hours);
            
            if (period === 'PM' && hours !== 12) hours += 12;
            if (period === 'AM' && hours === 12) hours = 0;
            
            return `${hours.toString().padStart(2, '0')}:${minutes}`;
        }

        function convertTo12Hour(time24) {
            let [hours, minutes] = time24.split(':');
            hours = parseInt(hours);
            const period = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12 || 12;
            
            return `${hours}:${minutes} ${period}`;
        }

        // Display class schedule
        function displayClassSchedule() {
            const today = new Date().getDay(); // 0 = Sunday, 1 = Monday, etc.
            const container = document.getElementById('classSchedule');
            const taskContainer = document.getElementById('classTasks');
            
            // Ensure classes array exists
            if (!trackerData.classes || !Array.isArray(trackerData.classes)) {
                trackerData.classes = [
                    { day: 1, name: 'Mathematics', time: '9:00 AM', duration: '2 hours' },
                    { day: 1, name: 'Physics', time: '2:00 PM', duration: '1.5 hours' },
                    { day: 3, name: 'Chemistry', time: '10:00 AM', duration: '2 hours' },
                    { day: 3, name: 'Biology', time: '3:00 PM', duration: '1.5 hours' },
                    { day: 4, name: 'Computer Science', time: '9:00 AM', duration: '2 hours' },
                    { day: 4, name: 'English', time: '1:00 PM', duration: '1 hour' }
                ];
                saveData();
            }
            
            // Days: 1 = Monday, 3 = Wednesday, 4 = Thursday
            const hasClassToday = [1, 3, 4].includes(today);
            
            if (!hasClassToday) {
                container.innerHTML = '<div class="no-class-message">üéâ No classes today! Enjoy your free day.</div>';
                taskContainer.innerHTML = '';
                return;
            }
            
            // Filter classes for today
            const todayClasses = trackerData.classes.filter(c => c.day === today);
            
            if (todayClasses.length === 0) {
                container.innerHTML = '<div class="no-class-message">üéâ No classes today! Enjoy your free day.</div>';
                taskContainer.innerHTML = '';
                return;
            }
            
            // Display class info
            const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            container.innerHTML = `
                <div style="background: #d4edda; padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                    <strong>üìÖ ${dayNames[today]} - Class Day</strong>
                    <div style="font-size: 0.9em; margin-top: 5px; color: #155724;">
                        You have ${todayClasses.length} class${todayClasses.length > 1 ? 'es' : ''} today
                    </div>
                </div>
            `;
            
            // Display class tasks
            let tasksHtml = '';
            todayClasses.forEach((cls, index) => {
                const taskId = `class-${today}-${index}`;
                const isCompleted = trackerData.tasks[taskId] || false;
                
                tasksHtml += `
                    <li class="task-item ${isCompleted ? 'completed' : ''}" data-task="${taskId}">
                        <input type="checkbox" class="checkbox" ${isCompleted ? 'checked' : ''}>
                        <span>${cls.name}</span>
                        <span class="task-time">${cls.time}</span>
                    </li>
                    <div class="meal-suggestion">‚è±Ô∏è Duration: ${cls.duration}</div>
                `;
            });
            
            taskContainer.innerHTML = tasksHtml;
            
            // Add event listeners to new class tasks
            taskContainer.querySelectorAll('.task-item').forEach(task => {
                task.addEventListener('click', toggleTask);
            });
        }

        // Show class settings
        window.showClassSettings = function() {
            // Ensure classes array exists
            if (!trackerData.classes || !Array.isArray(trackerData.classes)) {
                trackerData.classes = [];
            }
            
            document.getElementById('settingsPanel').classList.add('active');
            document.getElementById('overlay').classList.add('active');
            
            const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            let html = '<h3 style="color: #667eea; margin-bottom: 15px;">Your Classes</h3>';
            
            if (trackerData.classes.length === 0) {
                html += '<p style="text-align: center; color: #6c757d; margin: 20px 0;">No classes added yet. Click "Add New Class" to get started!</p>';
            } else {
                // Group classes by day
                const classByDay = {};
                trackerData.classes.forEach((cls, index) => {
                    if (!classByDay[cls.day]) classByDay[cls.day] = [];
                    classByDay[cls.day].push({ ...cls, index });
                });
                
                Object.keys(classByDay).sort().forEach(day => {
                    html += `<div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">`;
                    html += `<h4 style="color: #495057; margin-bottom: 10px;">${dayNames[day]}</h4>`;
                    
                    classByDay[day].forEach(cls => {
                        html += `
                            <div class="setting-item" style="background: white; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
                                <label>Class Name</label>
                                <input type="text" class="class-name" data-index="${cls.index}" value="${cls.name}" style="margin-bottom: 8px;">
                                <label>Time</label>
                                <input type="time" class="class-time" data-index="${cls.index}" value="${convertTo24Hour(cls.time)}" style="margin-bottom: 8px;">
                                <label>Duration</label>
                                <input type="text" class="class-duration" data-index="${cls.index}" value="${cls.duration}" placeholder="e.g., 2 hours">
                                <button onclick="deleteClass(${cls.index})" class="btn" style="background: #dc3545; margin-top: 8px; padding: 8px 15px;">Delete</button>
                            </div>
                        `;
                    });
                    html += '</div>';
                });
            }
            
            html += `
                <button class="btn" id="addNewClassBtn" style="width: 100%; margin-bottom: 10px;">+ Add New Class</button>
                <button class="btn" id="saveClassSettingsBtn">Save Changes</button>
            `;
            
            document.getElementById('settingsContent').innerHTML = html;
            
            // Attach event listeners
            document.getElementById('addNewClassBtn').addEventListener('click', addNewClass);
            document.getElementById('saveClassSettingsBtn').addEventListener('click', saveClassSettings);
        }

        // Delete class
        function deleteClass(index) {
            if (confirm('Are you sure you want to delete this class?')) {
                trackerData.classes = trackerData.classes.filter((_, i) => i !== index);
                saveData();
                showClassSettings(); // Refresh the settings panel
                displayClassSchedule(); // Update the schedule display
            }
        }

        // Add new class
        function addNewClass() {
            const name = prompt('Enter class name:');
            if (!name) return;
            
            const dayInput = prompt('Enter day (1=Monday, 2=Tuesday, 3=Wednesday, 4=Thursday, 5=Friday, 6=Saturday, 0=Sunday):');
            const day = parseInt(dayInput);
            
            if (isNaN(day) || day < 0 || day > 6) {
                alert('Invalid day! Please enter 0-6.');
                return;
            }
            
            const time = prompt('Enter time (e.g., 9:00 AM):');
            if (!time) return;
            
            const duration = prompt('Enter duration (e.g., 2 hours):');
            if (!duration) return;
            
            trackerData.classes.push({ day, name, time, duration });
            saveData();
            showClassSettings();
            displayClassSchedule();
        }

        // Save class settings
        function saveClassSettings() {
            // Get all inputs
            document.querySelectorAll('.class-name').forEach(input => {
                const index = parseInt(input.dataset.index);
                if (trackerData.classes[index]) {
                    trackerData.classes[index].name = input.value;
                }
            });
            
            document.querySelectorAll('.class-time').forEach(input => {
                const index = parseInt(input.dataset.index);
                if (trackerData.classes[index]) {
                    trackerData.classes[index].time = convertTo12Hour(input.value);
                }
            });
            
            document.querySelectorAll('.class-duration').forEach(input => {
                const index = parseInt(input.dataset.index);
                if (trackerData.classes[index]) {
                    trackerData.classes[index].duration = input.value;
                }
            });
            
            saveData();
            displayClassSchedule();
            closeSettings();
            alert('‚úÖ Class settings saved successfully!');
        }

        // Initialize on page load
        window.addEventListener('load', init);
    </script>
</body>
</html>
